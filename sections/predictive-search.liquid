{% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
{% liquid
  assign gst = settings
%}

{%- if predictive_search.performed -%}
  {% assign first_column_results_size = predictive_search.resources.queries.size
 | plus: predictive_search.resources.collections.size
 | plus: predictive_search.resources.pages.size
 | plus: predictive_search.resources.articles.size
  %}
  <div
    id="predictive-search-results"
    role="listbox"
    class="{% unless predictive_search.resources.products.size > 0 %} predictive-search__results-groups-wrapper--no-products{% endunless %}">
    {%- if first_column_results_size > 0 or predictive_search.resources.products.size > 0 -%}
      <div id="predictive-search-results-groups-wrapper" class="predictive-search__results-groups-wrapper mb-40 {% unless predictive_search.resources.queries.size > 0 or predictive_search.resources.collections.size > 0 %} predictive-search__results-groups-wrapper--no-suggestions{% endunless %}">
    {%- endif -%}
    {%- if first_column_results_size > 0 -%}
      <div class="predictive-search__result-group">
    {%- endif -%}
    {%- if first_column_results_size > 0 -%}
      </div>
    {%- endif -%}
    {%- if predictive_search.resources.products.size > 0
 or predictive_search.resources.articles.size > 0
 or predictive_search.resources.pages.size > 0
    -%}
      <div class="predictive-search__result-group">
        {%- if predictive_search.resources.products.size > 0 -%}
          <div>
            <p data-predictive-search-search-for-text class="text-center text-xl font-medium">
              {{- 'templates.search.search_for' | t: terms: predictive_search.terms -}}
            </p>
            <div
              id="predictive-search-results-products-list"
              class="predictive-search__results-list tp-grid tp-grid--2-col-mobile tp-grid--3-col-tablets tp-grid--5-col-desktop"
              role="group"
              aria-labelledby="predictive-search-products">
              {%- for product in predictive_search.resources.products limit: 5 -%}
                <div class="tp-grid__item tp-grid__item-{{ forloop.index }}">
                  {% render 'product-item-layout-1'
                    , card_product: product %}
                </div>
              {%- endfor -%}
            </div>
          </div>
        {%- endif -%}
      </div>
    {%- endif -%}
    {%- if first_column_results_size > 0 or predictive_search.resources.products.size > 0 -%}
      </div>
    {%- endif -%}
    <div id="predictive-search-option-search-keywords" class="predictive-search__search-for-button flex items-center justify-center">
      <button
        class="predictive-search__item predictive-search__item--term tp-btn tp-btn__primary"
        tabindex="-1"
        role="option"
        aria-selected="false">
        {{ 'templates.search.button_more' | t }}
      </button>
    </div>
  </div>

  <span class="hidden" data-predictive-search-live-region-count-value>
    {% liquid
      assign total_results = predictive_search.resources.products.size | plus: first_column_results_size
      if total_results == 0
        echo 'templates.search.no_results' | t: terms: predictive_search.terms
      else
        echo 'templates.search.results_with_count' | t: count: total_results | append: ': '
        if predictive_search.resources.queries.size > 0
          assign count = predictive_search.resources.queries.size | plus: predictive_search.resources.collections.size
          echo 'templates.search.results_suggestions_with_count' | t: count: count | append: ', '
        endif
        if predictive_search.resources.pages.size > 0
          assign count = predictive_search.resources.pages.size | plus: predictive_search.resources.articles.size
          echo 'templates.search.results_pages_with_count' | t: count: count | append: ', '
        endif
        if predictive_search.resources.products.size > 0
          echo 'templates.search.results_products_with_count' | t: count: predictive_search.resources.products.size
        endif
      endif
    %}
  </span>
{%- endif -%}